; Define your strings in an array
strings := ["الهيشه – مركز نجع حمادي - قنا"
           ,"الهيشة -مركز نجع حمادي - قنا"
           ,"القمانه - مركز نجع حمادي - قنا"
           ,"القمانة - مركز نجع حمادي -قنا"
           ,"الكوم الاحمر - مركز فرشوط - قنا"
           ,"بهجوره - مركز نجع حمادي - قنا"
           ,"بهجورة - مركز نجع حمادي - قنا"
           ,"القصر - مركز نجع حمادي - قنا"
           ,"الرحمانيه - مركز نجع حمادي - قنا"
           ,"الرحمانية - مركز نجع حمادي - قنا"
           ,"الرحمانيه قبلي – مركز نجع حمادي - قنا"
           ,"اولاد نجم - مركز نجع حمادي – قنا"
           ,"اولاد نجم التمه - مركز نجع حمادي – قنا"
           ,"اولاد نجم التمة - مركز نجع حمادي - قنا"
           ,"كوم البجا - مركز فرشوط - قنا"
           ,"هو - مركز نجع حمادي - قنا"
           ,"الغربي بهجوره - مركز نجع حمادي- قنا"
           ,"الشرقي بهجوره - مركز نجع حمادي - قنا"
           ,"زليتم - مركز نجع حمادي- قنا"
           ,"الصياد - مركز نجع حمادي - قنا"
           ,"فاو بحري - مركز دشنا - قنا"
           ,"فاو قبلي - مركز دشنا - قنا"
           ,"رفاعة - مركز فرشوط - قنا"
           ,"رفاعه - مركز فرشوط - قنا"
           ,"القبيبه - مركز فرشوط - قنا"
           ,"القبيبة - مركز فرشوط - قنا"
           ,"العركي - مركز فرشوط - قنا"
           ,"الحاج سلام - مركز فرشوط - قنا"
           ,"القناويه - مركز نجع حمادي - قنا"
           ,"القناوية - مركز نجع حمادي - قنا"
           ,"الدهسة - مركز فرشوط - قنا"
           ,"الدهسه - مركز فرشوط - قنا"
           ,"ابوعموري - مركز نجع حمادي - قنا"
           ,"الدرب - مركز نجع حمادي - قنا"
           ,"النجوع - مركز فرشوط - قنا"
           ,"البطحة - مركز نجع حمادي - قنا"
           ,"البطحه - مركز نجع حمادي - قنا"
           ,"العزازية - مركز دشنا - قنا"
           ,"العزازيه - مركز دشنا - قنا"
           ,"السمطا بحري - مركز دشنا - قنا"
           ,"العسيرات - مركز فرشوط - قنا"
           ,"النجاحيه - مركز نجع حمادي - قنا"
           ,"النجاحية - مركز نجع حمادي - قنا"
           ,"الشلايله - مركز نجع حمادي - قنا"
           ,"الشلايلة - مركز نجع حمادي - قنا"
           ,"الصعايده - مركز دشنا - قنا"
           ,"الصعايدة - مركز دشنا - قنا"
           ,"السلامية - مركز نجع حمادي - قنا"
           ,"السلاميه - مركز نجع حمادي - قنا"
           ,"حاصل علي دبلوم زراعه"
           ,"حاصل علي دبلوم زراعة"
           ,"حاصله علي دبلوم زراعه"
           ,"حاصلة علي دبلوم زراعة"
           ,"حاصل علي دبلوم صنايع"
           ,"حاصلة علي دبلوم صنايع"
           ,"حاصل علي دبلوم تجاره"
           ,"حاصل علي دبلوم تجارة"
           ,"حاصله علي دبلوم تجاره"
           ,"حاصلة علي دبلوم تجارة"
           ,"حاصل علي دبلوم ثانوي صناعي"
           ,"حاصلة علي دبلوم ثانوي صناعي"
           ,"حاصل علي ليسانس آداب"
           ,"حاصل علي ليسانس اداب"
           ,"حاصلة علي ليسانس آداب"
           ,"حاصلة علي ليسانس اداب"
           ,"حاصل علي ليسانس السن اللغه الانجليزيه"
           ,"حاصل علي ليسانس حقوق"
           ,"حاصلة علي ليسانس السن اللغه الانجليزيه"
           ,"حاصلة علي ليسانس حقوق"
           ,"حاصل علي بكالوريوس تجارة"
           ,"حاصل علي بكالوريوس تجاره"
           ,"حاصلة علي بكالوريوس تجارة"
           ,"حاصلة علي بكالوريوس تجاره"
           ,"حاصل علي بكالوريوس خدمه اجتاعيه"
           ,"حاصل علي بكالوريوس خدمة اجتماعية"
           ,"حاصلة علي بكالوريوس خدمه اجتاعيه"
           ,"حاصلة علي بكالوريوس خدمة اجتماعية"
           ,"حاصلة علي بكالوريوس علوم"
           ,"حاصلة علي بكالوريوس علوم"
           ,"حاصل علي بكالوريوس علوم زراعيه"
           ,"حاصل علي بكالوريوس علوم زراعية"
           ,"حاصلة علي بكالوريوس علوم زراعيه"
           ,"حاصلة علي بكالوريوس علوم زراعية"
           ,"حاصل علي بكالوريوس علوم طبية تطبيقية"
           ,"حاصل علي بكالوريوس علوم طبية تطبيقية"
           ,"حاصل علي بكالوريوس سياحة وفنادق"
           ,"حاصل علي بكالوريوس سياحه وفنادق"
           ,"حاصلة علي بكالوريوس سياحة وفنادق"
           ,"حاصلة علي بكالوريوس سياحه وفنادق"
           ,"حاصل علي بكالوريوس تربية نوعية"
           ,"حاصل علي بكالوريوس تربيه نوعيه"
           ,"حاصلة علي بكالوريوس تربية نوعية"
           ,"حاصلة علي بكالوريوس تربيه نوعيه"
           ,"حاصل علي معهد فني تجاري"
           ,"حاصلة علي معهد فني تجاري"
           ,"حاصل علي معهد خدمه اجتماعيه"
           ,"حاصل علي معهد خدمه اجتماعية"
           ,"حاصلة علي معهد خدمه اجتماعيه"
           ,"حاصلة علي معهد خدمه اجتماعية"
           ,"خفير نظامي مركز شرطة نجع حمادي"
           ,"ربة منزل"
           ,"ربه منزل"
           ,"تاجر بقالة بالقطاعي"
           ,"حاصل علي دبلوم ثانوي زراعي"
           ,"معلم ادارة نجع حمادي التعليميه"
           ,"كبير اخصائيين بدرجة مدير عام الادارة الزراعية بنجع حمادي"
           ,"معلم اول تربية رياضيه معهد بنين بهجوره الازهري"
           ,"اخصائي اجتماعي خبير ادارة دشنا التعليميه"
           ,"معلم اول أ مدرسة القصرللتعليم الاساسي"
           ,"معلم اول ا مدرسة العساكره الابتدائية بهو"
           ,"الرحمانيه قبلي -  شارع العمده - مركز نجع حمادي - قنا "
           ,"الهيشه - عزبة آدم مركز نجع حمادي - قنا "
           ,"الحفناويه - مركز نجع حمادي - قنا"
           ,"الصعايده -  ش السنجق  - مركز دشنا - قنا "
           ,"عزبة البوصه- شارع محمد ابوبكر - مركز نجع حمادي - قنا"
           ,"شارع 30مارس - مركز نجع حمادي - قنا"
           ,"الحلفاية بحري - مركز نجع حمادي - قنا"
           ,"فني تشغيل مياه بشركة مياه الشرب والصرف الصحي بقنا"
           ,"معلمة اول رياض اطفال ادارة نجع حمادي التعليميه"
           ,"مراقب ممتاز آمن ووقت مصانع سكر نجع حمادي"
           ,"فني تغذية - بمعهد فتيات نجع حمادي الازهري الثانوي"
           ,"معلم اول أ بمعهد بنين نجع حمادي النموذجي"
           ,"اولاد نجم التمه - نجع الخطيب - مركز نجع نجع حمادي - قنا"
           ,"اولاد نجم بهجوره - مركز نجع حمادى - قنا"
           ,"ابوعمورى - نجع عمران - مركز نجع حمادى"
           ,"الرحمانية قبلي - دوار العمدة عبدالملاك - مركز نجع حمادي - قنا"
           ,"نجع قابول - الغربي بالسلاميه - مركز نجع حمادي - قنا"
           ,"بهجوره - عزبة ابواسكندر - مركز نجع حمادي"
           ,"الصعايده - ش الزهراء - مركز دشنا - قنا"
           ,"عزبة البوصه - مركز نجع حمادي - قنا"
           ,"الغربى السلامية - نجع قابول - مركز نجع حمادي - قنا"
           ,"هو - عزبة الامير - مركز نجع حمادى - قنا"
           ,"الغربى بهجوره - الكلح - مركز نجع حمادى - قنا"
           ,"هو - ش الشيخ عبدالله القرشي - مركز نجع حمادي - قنا"
           ,"شارع بورسعيد - خلف الطوابين - مركز نجع حمادي - قنا"
           ,"اولاد نجم التمه - نجع عبدالقادر - مركز نجع حمادي - قنا"
           ,"الساحل - شارع الجمهوريه - مركز نجع حمادى - قنا"
           ,"فني زراعة بشركة كلاسيك لادارة المنشأت السياحيه"
           ,"الهيشه -نجع ورور مركز نجع حمادي - قنا "
           ,"العزازية - ش الجمعية التعاونية -مركز دشنا - قنا "
           ,"كاتب ثان بمدرية الاسكان والمرافق نجع حمادي"
           ,"هو - عزبة الامير - ش مسجد الزهراء - مركز نجع حمادي - قنا "
           ,"الشعانيه - مركز نجع حمادي - قنا"
           ,"ابوعمورى بجوار الوحده الصحيه - مركز نجع حمادي - قنا"
           ,"البطحة - ابوعمورى - مركز نجع حمادى - قنا"
           ,"بهجوره - شارع الجلاء - مركز نجع حمادي - قنا"
           ,"دشنا - مركز دشنا - قنا"
           ,"ميكانيكي ديزل بورشة قاطرات السكه الحديد بنجع حمادي"
           ,"حاصل علي بكالوريوس لعلوم الحاسب ونظم المعلومات"
           ,"امين شرطة ثالث وزارة الداخليه"
           ,"منطقة السوق - خلف الاستاد - مركز نجع حمادي - قنا"
           ,"شارع السوق - خلف الاستاد - مركز نجع حمادي - قنا"
           ,"العزازيه - ش المحطه - مركز دشنا - قنا"
           ,"الهيشه - نجع الغليظ - مركز نجع حمادي - قنا "
           ,"اولاد نجم التمه - كوم السيد - مركز نجع حمادي – قنا "
           ,"حاره الكموني - مركز نجع حمادي - قنا"
           ,"شارع الجمهوريه - حارة البوهي - مركز نجع حمادي - قنا"
           ,"حاصله علي دبلوم فني اداره وخدمات"
           ,"هو - ش الشيخ عبدالله النقراشي - مركز نجع حمادي - قنا"
           ,"حاصلة علي ليسانس في اصول الدين "
           ,"حاصله علي دبلوم صنايع"
           ,"فني أول تشغيل وصيانة معدات مصانع السكر بنجع حمادي"
           ,"ش 15 مايو  - مركز نجع حمادي - قنا"
           ,"حاصله علي الثانوية الازهرية"
           ,"حاصل علي الثانوية الازهرية"
           ,"37ش المطحن القديم - مركز نجع حمادي - قنا"
           ,"الحفناويه - نجع جوده - مركز نجع حمادي - قنا"
           ,"زليتم - الغربي بهجوره - مركز نجع حمادي- قنا"
           ,"هو - شارع السويقه - مركز نجع حمادي - قنا"
           ,"هو - حاجر الجبل - مركز نجع حمادي - قنا"
           ,"حاصلة علي ثانوية عامة"
           ,"الغربى بهجوره - الكلح الغربي - مركز نجع حمادى - قنا"
           ,"الكلح - الغربي بهجوره - مركز نجع حمادى - قنا"
           ,"حاصل علي بكالوريوس نظم معلومات ادارية"
           ,"الكلح الغربي - بهجوره - مركز نجع حمادي - قنا"
           ,"امام و خطيب ومدرس ادراة اوقاف الغربي بهجورة"
           ,"الدرب - عزبة نقيب - مركز نجع حمادي - قنا"
           ,"حاصلة علي دبلوم ثانوي تجاري"
           ,"ابوعمورى - البطحة - مركز نجع حمادى - قنا"
           ,"حاصل علي دبلوم ثانوي تجاري"
           ,"حاصلة علي دبلوم ثانوي للادارة والخدمات"
           ,"الغربي بهجوره - الكلح  - مركز نجع حمادي -قنا"
           ,"القمانه - سلاجه - مركز نجع حمادي - قنا"
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""
           ,""]

; Hotkey to show the search box (e.g., Ctrl+Shift+S)
\::ShowSearchBox()

; Function to show the search box
ShowSearchBox()
{
    global strings
    ; Get the mouse position
    CoordMode, Mouse, Screen  ; Use screen coordinates
    MouseGetPos, mouseX, mouseY

    ; Create the GUI and position it near the mouse
    Gui, SearchGUI:New, -Caption +ToolWindow +AlwaysOnTop, String Search
    ; Set the font for the GUI
    Gui, Font, s13, Calibri Light  ; Set font size to 12 and font family to Consolas

    Gui, SearchGUI:Add, Edit, vSearchText gUpdateSearch w400
    Gui, SearchGUI:Add, ListBox, vStringList gSelectString w400 r15
    Gui, SearchGUI:Show, x%mouseX% y%mouseY%, String Search
    GuiControl, Focus, SearchText
}

; Function to update the search results as you type
UpdateSearch()
{
    global strings, SearchText, StringList  ; Declare control variables as global
    Gui, SearchGUI:Submit, NoHide
    GuiControl, -Redraw, StringList  ; Disable redraw to improve performance
    GuiControl,, StringList, |  ; Clear the list
    for index, fullText in strings
    {
        if InStr(fullText, SearchText)  ; Search only in the full strings
        {
            GuiControl,, StringList, %fullText%
        }
    }
    GuiControl, +Redraw, StringList  ; Re-enable redraw
}

; Function to handle selection from the list
SelectString()
{
    global StringList  ; Declare control variable as global
    Gui, SearchGUI:Submit, NoHide
    if (StringList != "")  ; Ensure something is selected
    {
        Gui, SearchGUI:Destroy  ; Close the search box
        SendInput, %StringList%  ; Send the selected text to the active window
    }
}

; Close the GUI if Escape is pressed
GuiEscape:
GuiClose:
    Gui, SearchGUI:Destroy
return